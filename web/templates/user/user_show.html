{% extends "layout.html" %}
{% import "macros/forms.html" as forms %}

{% block content %}

    <div class="subnav subnav-fixed">
        <ul class="nav nav-pills">
            <li><a href="#basedata">Basisdaten</a></li>
            <li><a href="#traffic">Traffic</a></li>
            <li><a href="#hosts">Hosts</a></li>
            <li><a href="#logs">Logeintr채ge</a></li>
            <li><a href="#finance">Kontoeintr채ge</a></li>
            <li><a href="#groups">Gruppen</a></li>
        </ul>
    </div>


    {# Stammdaten #}
    <section id="basedata">
        <div class="head">Basisdaten</div>
        <div class="body">
            {% include "user/_user_show_basedata.html" with context %}
        </div>
    </section>


    {# Traffic #}
    <section id="traffic">
        <div class="head">Traffic</div>
        <div class="body">
            {% include "user/_user_show_traffic.html" with context %}
        </div>
    </section>


    {# Hosts-Tabelle #}
    <section id="hosts">
        <div class="head">Hosts</div>
        <div class="body">
            {% include "user/_user_show_hosts.html" with context %}
        </div>
    </section>


    {# Logeintrage des Nutzers #}
    <section id="logs">
        <div class="head">Logeintr채ge</div>
        <div class="body">
            {% include "user/_user_show_logs.html" with context %}
        </div>
    </section>


    {# Kontostand des Nutzers #}
    <section id="finance">
        <div class="head">Kontoeintr채ge</div>
        <div class="body">
            {% include "user/_user_show_finance.html" with context %}
        </div>
    </section>


    {# Gruppen des Nutzers #}
    <section id="groups">
        <div class="head">Gruppen</div>
        <div class="body">
            {% include "user/_user_show_groups.html" with context %}
        </div>
    </section>
{% endblock %}


{% block page_script %}
    <script type="text/javascript" src="{{ url_for("static", filename="highcharts/highcharts.js") }}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var trafficchart = new Highcharts.Chart({
                chart:{
                    renderTo:'trafficchart',
                    type:'column',
                    width:600,
                    height:250,
                    animation:false
                },
                title:{
                    text:null
                },
                plotOptions:{
                    series:{ animation:false },
                    column:{ stacking:'normal' }
                },
                legend:{
                    enabled:false
                },
                tooltip:{
                    enabled:true,
                    formatter:function () {
                        var tooltip = '<b>' + this.x + '</b>';
                        $.each(this.points, function (i, point) {
                            tooltip += '<br />' + point.series.name + ': ' + point.y + 'Mb';
                        });
                        return tooltip;
                    },
                    shared:true
                },
                xAxis:{
                    categories:['Montag', 'Dienstag', 'Mittwoch',
                        'Donnerstag', 'Freitag', 'Samstag', 'Sonntag']
                },
                yAxis:{
                    title:{ text:null }
                },
                series:[
                    { name: 'Input', data: [{% for entry in trafficvolume_in %}{{ entry.size / 1024 / 1024 }},{% endfor %}], stack: 0 },
                    { name: 'Output', data: [{% for entry in trafficvolume_out %}{{ entry.size / 1024 / 1024 }},{% endfor %}], stack: 1 }
                ]
            });
        });

    </script>


    <script type="text/javascript">
        $(document).ready(function () {
            var $win = $(window)
                    , $nav = $('.subnav')
                    , navTop = $('.subnav').length && $('.subnav').offset().top - 40
                    , isFixed = 1;
            processScroll();

            $nav.on('click', function () {
                if (!isFixed) setTimeout(function () {
                    $win.scrollTop($win.scrollTop() - 47);
                }, 10)
            });

            $win.on('scroll', processScroll);
            function processScroll() {
                var i, scrollTop = $win.scrollTop();
                if (scrollTop >= navTop && !isFixed) {
                    isFixed = 1;
                    $nav.addClass('subnav-fixed');
                } else if (scrollTop <= navTop && isFixed) {
                    isFixed = 0;
                    $nav.removeClass('subnav-fixed');
                }
            }
        });
    </script>
{% endblock %}