{% extends "layout.html" %}

{% set page_title = "Konto: " + name %}

{% set inverted = false %}

{% macro render_column_headings() %}
    <th>Erstellt am</th>
    <th>GÃ¼ltig ab</th>
    <th>Beschreibung</th>
    <th>Wert</th>
{% endmacro %}

{% macro render_split(split, cell_class="", absolute=false) %}
    {% if split %}
        <td class="{{ cell_class }}">{{ split.transaction.transaction_date|datetime }}</td>
        <td class="{{ cell_class }}">{{ split.transaction.valid_date|date }}</td>
        <td class="{{ cell_class }}"><a href="{{ url_for(".show_transaction", transaction_id=split.transaction_id) }}">{{ split.transaction.description }}</a></td>
        <td class="{{ cell_class }}">{{ split.amount|abs|money if absolute else split.amount|money }}</td>
    {% endif %}
{% endmacro %}

{% block content %}
    <div class="btn-group right">
        <button type="button" class="btn btn-default">Kontenform</button>
        <button type="button" class="btn btn-default">Staffelform</button>
    </div>
    <h2>Staffelform</h2>
    <div class="row">
        <table class="table table-striped">
            <thead>
                <tr>
                    {{ render_column_headings() }}
                </tr>
            </thead>
            <tbody>
            {%- for split in splits %}
                <tr class="{{ "success" if (split.amount > 0 and not inverted) or (split.amount <= 0 and inverted) else "danger" }}">
                    {{ render_split(split) }}
                </tr>
            {%- endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3">Saldo</td>
                    <td>{{ balance|money }}</td>
                </tr>
            </tfoot>
        </table>
    </div>
    <h2>Kontenform</h2>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th colspan="4" style="width: 50%;" class="text-center">Soll</th>
                <th colspan="4" style="width: 50%;" class="text-center">Haben</th>
            </tr>
            <tr>
                {% for ignore in range(2) %}
                    {{ render_column_headings() }}
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for debit_split, credit_split in typed_splits %}
                <tr>
                    {{ render_split(debit_split, "danger" if inverted else "success", true) }}
                    {{ render_split(credit_split, "success" if inverted else "danger", true) }}
                </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="7" class="text-right">Saldo</td>
                <td colspan="1">{{ balance|money }}</td>
            </tr>
        </tfoot>
    </table>
{% endblock %}
